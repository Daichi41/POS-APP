# フェーズ4 テスト・品質保証

## 目的
- 本番運用に耐える品質を検証し欠陥を摘出・修正する
- 重大インシデントを未然に防ぎ、運用チームへ信頼できる成果物を引き渡す

## テスト計画
- 範囲：フロント、バックエンドAPI、オフライン同期、CSV連携、監視/アラート設定
- フェーズ：単体 → 結合 → システム → UAT → パフォーマンス/セキュリティ
- 体制：QAリード1名、テスター2名、開発支援1名、事業部UAT担当2名
- ツール：Jira（欠陥管理）、TestRail（テストケース）、GitHub Actions、BrowserStack（クロスブラウザ）

## テストケース作成
- 想定カバレッジ
  - ハッピーパス：会計・取消・CSV出力・レシート送信
  - エラー系：通信断、在庫不足、PIN誤入力、APIタイムアウト、オフライン同期失敗
  - 非機能：レスポンスタイム、CPU/メモリ使用率、ログ出力、アクセシビリティ（キーボード操作、スクリーンリーダー）
- ケース粒度：1シナリオ1ケース、前提・手順・期待結果を明記しスクリーンショットを添付

## テスト環境
- ステージング：本番同等構成（ECS、Aurora、S3、SESサンドボックス）
- テストデータ：商品マスタ150件、在庫変動シナリオ10パターン、取引履歴3日分
- 端末：iPad第9世代2台、Androidハンディ2台、ブラウザChrome/Safari/Edge最新
- ネットワークシミュレーション：Chrome DevToolsで3G遅延、PacketLoss 5%を再現

## 実行計画
- 単体テスト：開発チームが自動化テストをCIで実行、レポートをQAへ共有
- 結合テスト：API + フロント連携、Mock→本番API切替確認、10ケース
- E2Eテスト：Cypress/Playwrightで40ケース、自動リグレッションを毎晩実行
- 負荷テスト：k6でRPS 2→10まで漸増、CPU 70%以内、エラー率1%未満を確認
- セキュリティチェック：OWASP Top10簡易診断、JWT署名確認、ログイン試行制限
- UAT：事業部担当が実店舗シナリオテスト、フィードバックをUATレポートに記録

## 欠陥管理
- 優先度基準：Blocker（取引不可）、High（主要機能不具合）、Medium（回避策あり）、Low（UI改善）
- SLA：Blockerは24時間以内修正、Highは2営業日、Medium 5営業日、Lowは次リリースへ
- トリアージ会議：平日17:00に15分実施、差し戻しルールを設定

## 品質メトリクス
- テスト進捗：実行率80%以上、未実行ケース0件で移行
- 欠陥密度：テストケース100件あたり重大欠陥2件以下
- 回帰テスト結果：自動テスト成功率95%以上
- アクセシビリティ：WCAG 2.1 AAの主要項目に準拠（色コントラスト、キーボード操作）

## 成果物
- テスト報告書（実施結果、欠陥一覧、品質評価、残リスク）
- ユーザビリティテスト記録（動画、ヒアリング結果、改善提案）
- 移行リハーサル結果、チェックリスト（データ移行手順、ロールバック手順）
- 監視・アラート設定証跡（CloudWatch Dashboard/アラーム一覧）

## 移行条件
- Blocker/Highの欠陥がゼロ、再テスト完了
- UATサインオフ（事業責任者・店舗リーダー）を取得
- 性能テストで閾値クリア、アラート設定が本番と同等
- 監査ログ・バックアップ・復旧手順が検証済みで運用文書に反映
